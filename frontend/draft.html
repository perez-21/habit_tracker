<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Habit Progress</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body class="bg-light">
    <div class="container mt-5">
      <h2 class="text-center mb-4">
        ðŸ“Š Habit Progress: <span id="habitName">Practice Coding</span>
      </h2>

      <div class="row">
        <!-- Completion Stats -->
        <div class="col-md-6">
          <div class="card p-3 mb-3">
            <h5>
              Total Completions:
              <span id="totalCompletions" class="text-primary">0</span>
            </h5>
            <h5>
              Current Streak:
              <span id="currentStreak" class="text-success">0</span> days
            </h5>
            <h5>
              Longest Streak:
              <span id="longestStreak" class="text-warning">0</span> days
            </h5>
          </div>
        </div>

        <!-- Completion Rate -->
        <div class="col-md-6">
          <div class="card p-3 mb-3">
            <h5>Completion Rate</h5>
            <div class="progress">
              <div
                id="completionRateBar"
                class="progress-bar bg-success"
                role="progressbar"
                style="width: 0%"
              >
                <span id="completionRateText">0%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Chart Section -->
      <div class="card p-3" id="habit-chart-container">
        <h5 class="mb-3">ðŸ“ˆ Progress Over Time</h5>
        <canvas id="habitChart"></canvas>
      </div>
    </div>

    <script>
      // Mock Habit Data (Replace with real data from your database)
      const habitData = {
        name: "Practice Coding",
        totalCompletions: 25,
        totalDays: 30, // Days tracked
        currentStreak: 5,
        longestStreak: 12,
        dailyCompletionHistory: [
          1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1,
          1, 0, 1, 1, 1, 1, 1,
        ],
      };

      // Update Habit Stats
      document.getElementById("habitName").textContent = habitData.name;
      document.getElementById("totalCompletions").textContent =
        habitData.totalCompletions;
      document.getElementById("currentStreak").textContent =
        habitData.currentStreak;
      document.getElementById("longestStreak").textContent =
        habitData.longestStreak;

      // Calculate Completion Rate
      const completionRate =
        (habitData.totalCompletions / habitData.totalDays) * 100;
      document.getElementById(
        "completionRateText"
      ).textContent = `${completionRate.toFixed(1)}%`;
      document.getElementById(
        "completionRateBar"
      ).style.width = `${completionRate}%`;

      // Generate Chart Data
      const labels = Array.from(
        { length: habitData.totalDays },
        (_, i) => `Day ${i + 1}`
      );
      const data = habitData.dailyCompletionHistory.map((val) => val * 100); // Convert 0/1 to percentage

      // Render Chart.js Line Chart
      const ctx = document.getElementById("habitChart").getContext("2d");
      new Chart(ctx, {
        type: "line",
        data: {
          labels: labels,
          datasets: [
            {
              label: "Daily Completion (%)",
              data: data,
              borderColor: "rgba(75, 192, 192, 1)",
              backgroundColor: "rgba(75, 192, 192, 0.2)",
              borderWidth: 2,
              fill: true,
            },
          ],
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
            },
          },
        },
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
